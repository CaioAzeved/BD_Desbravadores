CREATE TABLE tb_endereco (
  id_endereco INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  logradouro varchar NOT NULL,
  bairro varchar NOT NULL,
  numero varchar,
  complemento varchar,
  cidade varchar NOT NULL,
  estado varchar(2) NOT NULL,
  pais varchar NOT NULL,
  dt_insercao timestamp DEFAULT current_timestamp,
  dt_atualizacao timestamp DEFAULT current_timestamp ON UPDATE current_timestamp
);

CREATE TABLE tb_pessoa (
  id_pessoa INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  nome varchar NOT NULL,
  cpf varchar(11),
  id_endereco integer REFERENCES tb_endereco,
  telefone varchar(11),
  genero varchar(1) NOT NULL,
  dt_insercao timestamp DEFAULT current_timestamp,
  dt_atualizacao timestamp DEFAULT current_timestamp ON UPDATE current_timestamp
);

CREATE TABLE tb_doacao (
  id_doacao INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  id_doador integer NOT NULL REFERENCES tb_pessoa,
  valor decimal(10,2) NOT NULL,
  metodoPagamento varchar NOT NULL,
  dt_insercao timestamp DEFAULT current_timestamp,
  dt_atualizacao timestamp DEFAULT current_timestamp ON UPDATE current_timestamp
);

CREATE TABLE tb_contatoEmergencial (
  id_contatoEmergencial INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  nome varchar NOT NULL,
  telefone varchar(11) NOT NULL,
  dt_insercao timestamp DEFAULT current_timestamp,
  dt_atualizacao timestamp DEFAULT current_timestamp ON UPDATE current_timestamp
);

CREATE TABLE tb_unidade (
  id_unidade INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  nome varchar NOT NULL,
  genero varchar(1) NOT NULL,
  faixa_etaria varchar
  dt_insercao timestamp DEFAULT current_timestamp,
  dt_atualizacao timestamp DEFAULT current_timestamp ON UPDATE current_timestamp
);

CREATE TABLE tb_membro (
  id_membro integer PRIMARY KEY,
  cargo varchar,
  id_contatoEmergencial integer NOT NULL REFERENCES tb_contatoEmergencial,
  grupo varchar NOT NULL,
  dt_nascimento date NOT NULL,
  id_unidade integer REFERENCES tb_unidade,
  dt_insercao timestamp DEFAULT current_timestamp,
  dt_atualizacao timestamp DEFAULT current_timestamp ON UPDATE current_timestamp
);

CREATE TABLE tb_especialidade (
  codigo integer PRIMARY KEY,
  area varchar(2) NOT NULL,
  nivel int NOT NULL,
  ano varchar(4) NOT NULL,
  instituicao varchar NOT NULL,
  dt_insercao timestamp DEFAULT current_timestamp,
  dt_atualizacao timestamp DEFAULT current_timestamp ON UPDATE current_timestamp
);

CREATE TABLE tb_membro_especialidade (
  id_membro integer REFERENCES tb_membro,
  id_especialidade integer REFERENCES tb_especialidade,
  id_instrutor integer NOT NULL REFERENCES tb_membro check (tb_membro.grupo = 'Liderança'),
  dt_insercao timestamp DEFAULT current_timestamp,
  dt_atualizacao timestamp DEFAULT current_timestamp ON UPDATE current_timestamp,
  PRIMARY KEY (id_membro, id_especialidade)
);

CREATE TABLE tb_evento (
  id_evento INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  descricao varchar,
  taxa decimal(10,2) NOT NULL,
  organizador integer NOT NULL REFERENCES tb_membro,
  dt_ida date NOT NULL,
  dt_volta date NOT NULL,
  dt_insercao timestamp DEFAULT current_timestamp,
  dt_atualizacao timestamp DEFAULT current_timestamp ON UPDATE current_timestamp
);

CREATE TABLE tb_membro_evento (
  id_membro integer REFERENCES tb_membro,
  id_evento integer REFERENCES tb_evento,
  taxaSituacao varchar NOT NULL,
  dt_insercao timestamp DEFAULT current_timestamp,
  dt_atualizacao timestamp DEFAULT current_timestamp ON UPDATE current_timestamp,
  PRIMARY KEY (id_membro, id_evento)
);

CREATE TABLE tb_classe (
  id_classe INTEGER GENERATED BY DEFAULT AS IDENTITY PRIMARY KEY,
  nome varchar NOT NULL,
  dt_insercao timestamp DEFAULT current_timestamp,
  dt_atualizacao timestamp DEFAULT current_timestamp ON UPDATE current_timestamp
);

CREATE TABLE tb_membro_classe (
  id_membro integer REFERENCES tb_membro,
  id_classe integer REFERENCES tb_classe,
  dt_insercao timestamp DEFAULT current_timestamp,
  dt_atualizacao timestamp DEFAULT current_timestamp ON UPDATE current_timestamp,
  PRIMARY KEY (id_membro, id_classe)
);

COMMENT ON COLUMN tb_pessoa.genero IS 'M or F';

COMMENT ON COLUMN tb_membro.grupo IS 'desbravador ou liderança';

COMMENT ON COLUMN tb_unidade.genero IS 'M, F ou L(unidade de Liderança)';

COMMENT ON COLUMN tb_unidade.faixa_etaria IS 'Escrever qual a faixa etária comum para os desbravadores, ex.: 10-12; caso unidade de liderança, escrever: ''16+''';

COMMENT ON COLUMN tb_endereco.estado IS 'Sigla do estado';

COMMENT ON COLUMN tb_membro_evento.taxaSituacao IS 'Pago, Isento ou Pendente';

COMMENT ON COLUMN tb_doacao.metodoPagamento IS 'pix, dinheiro';

insert into tb_endereco (logradouro, bairro, numero, complemento, cidade, estado, pais)
values
('Rua Senador da Silva', 'Neópolis', '2023', NULL, 'Natal', 'RN', 'Brasil'),
('Avenida Santa Teresa', 'CEHAB', '45', NULL, 'Macaíba', 'RN', 'Brasil'),
('Rua Francisco Alencar', 'Petrópolis', '1010', 'apt. 102', 'Natal', 'RN', 'Brasil'),
('Praça Nelson Miranda', 'Pitimbú', '87', NULL, 'Natal', 'RN', 'Brasil'),
('Avenida Agamenom Magalhães', 'Planalto', '3409', NULL, 'Natal', 'RN', 'Brasil'),
('Rua Virginópolis', 'Nova Parnamirim', '75', NULL, 'Parnamirim', 'RN', 'Brasil'),
('Rua Pintor Geraldo de Azevedo', 'Mirassol', '300', 'apt. 805', 'Natal', 'RN', 'Brasil'),
('Travessa Piloto Mário Melo', 'Emaús', '67', NULL, 'Parnamirim', 'RN', 'Brasil'),
('Avenida Cristo Redentor', 'Nova Descoberta', '42', NULL, 'Natal', 'RN', 'Brasil'),
('Avenida Lima e Silva', 'Lagoa Nova', '903', 'apt. 1003', 'Natal', 'RN', 'Brasil');

insert into tb_pessoa (nome, cpf, id_endereco, telefone, genero)
values 
('Mateus', '12343234521', 1, '84993247164', 'M'),
('Maria', '09876789543', 2, '87996785432', 'F'), 
(),
(),
(),
(),
(),
(),
(),
();

Select * from tb_endereco;
Select * from tb_pessoa;